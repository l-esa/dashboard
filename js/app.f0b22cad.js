(function(e){function t(t){for(var a,r,o=t[0],c=t[1],l=t[2],m=0,d=[];m<o.length;m++)r=o[m],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},s={app:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dashboard/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"28e4":function(e,t,n){"use strict";n("6b37")},"2d35":function(e,t,n){},3280:function(e,t,n){e.exports=n.p+"img/dtu.5d49d479.png"},"47de":function(e,t,n){"use strict";n("c48e")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("b-navbar",{staticClass:"shadow",attrs:{toggleable:"lg",type:"dark",variant:"dark"}},[a("b-navbar-brand",{attrs:{href:"#"}},[a("img",{staticClass:"d-inline-block align-top",attrs:{src:n("3280"),alt:"DTU",height:"30"}}),e._v(" Beamline ")]),a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",[a("b-nav-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-streams",modifiers:{"sidebar-streams":!0}}]},[e._v("Streams")]),a("b-nav-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-miners",modifiers:{"sidebar-miners":!0}}]},[e._v("Miners")]),a("b-nav-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-instances",modifiers:{"sidebar-instances":!0}}]},[e._v("Instances")])],1),a("b-navbar-nav",{staticClass:"ml-auto"},[a("b-nav-item",[e._v("About")])],1)],1)],1),a("SidebarMiners",{attrs:{miners:e.miners,minersStatus:e.minersStatus},on:{"add-miner":e.addMiner}}),a("SidebarStreams",{attrs:{streams:e.streams},on:{"add-stream":e.addStream}}),a("SidebarInstances",{attrs:{streams:e.streams,miners:e.miners,instances:e.instances,instancesStatus:e.instancesStatus},on:{"create-instance":e.createInstance}}),a("b-container",{attrs:{fluid:""}},[a("b-row",[a("b-col",[a("router-view",{attrs:{instances:e.instances,instancesStatus:e.instancesStatus},on:{"delete-instance":e.deleteInstance,"start-instance":e.startInstance,"stop-instance":e.stopInstance}})],1)],1)],1)],1)},i=[],r=(n("7db0"),n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-sidebar",{attrs:{id:"sidebar-streams",title:"Streams",shadow:"",backdrop:""},scopedSlots:e._u([{key:"footer",fn:function(t){return[n("div",{staticClass:"p-3"},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-stream",modifiers:{"new-stream":!0}}],attrs:{block:""}},[n("font-awesome-icon",{attrs:{icon:"plus"}}),e._v(" New stream ")],1)],1)]}}])},[n("b-list-group",{staticClass:"py-2",attrs:{flush:""}},e._l(e.streams,(function(t){return n("b-list-group-item",{key:t.name,staticClass:"bg-light"},[n("font-awesome-icon",{attrs:{icon:"film"}}),e._v(" "+e._s(t.processName)),n("br"),n("small",[n("font-awesome-icon",{attrs:{icon:"server"}}),e._v(" "),n("code",[e._v(e._s(t.brokerHost))]),e._v(" / "),n("code",[e._v(e._s(t.topicBase))])],1)],1)})),1)],1),n("NewStream",{attrs:{streams:e.streams},on:{"add-stream":function(t){return e.$emit("add-stream",t)}}})],1)}),o=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"new-stream",title:"New Stream"},on:{ok:e.handleOk}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[n("ValidatedInputText",{attrs:{label:"Process name:",placeholder:"Process name",error:"Enter process name (at lest 2 character)",type:"text",state:e.validateState("processName")},model:{value:e.processName,callback:function(t){e.processName=t},expression:"processName"}}),n("ValidatedInputText",{attrs:{label:"MQTT-XES broker:",placeholder:"broker.host.com",error:"Enter the host of the broker (examples: <code>broker.host.net</code>)",type:"text",state:e.validateState("brokerHost")},model:{value:e.brokerHost,callback:function(t){e.brokerHost=t},expression:"brokerHost"}}),n("ValidatedInputText",{attrs:{label:"MQTT base topic:",placeholder:"topic/moreSpecific",error:"Enter the base topic",type:"text",state:e.validateState("topicBase")},model:{value:e.topicBase,callback:function(t){e.topicBase=t},expression:"topicBase"}})],1)])},l=[],u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["choice"==e.type.toLowerCase()?n("div",[n("b-form-group",{attrs:{label:e.label}},e._l(e.placeholder.split(";"),(function(t){return n("b-form-radio",{key:t,attrs:{state:e.state,name:e.label,value:t},on:{input:e.update}},[e._v(e._s(t))])})),1)],1):n("b-form-group",{attrs:{label:e.label,state:e.state}},["file"==e.type.toLowerCase()?n("b-form-file",{attrs:{placeholder:"Upload the file","drop-placeholder":"Drop file here...",state:e.state},on:{input:e.updateUpload}}):n("b-form-input",{attrs:{type:"text",placeholder:e.placeholder,value:e.value,state:e.state},on:{input:e.update}}),n("b-form-invalid-feedback",{attrs:{state:e.state},domProps:{innerHTML:e._s(e.error)}})],1)],1)},m=[],d=n("bc3a"),p=n.n(d),h={name:"ValidatedInputText",props:["host","label","placeholder","error","value","state","type"],methods:{updateUpload:function(e){var t=this,n={headers:{"Content-Type":"multipart/form-data"}},a=new FormData;a.append("file",e),p.a.post(this.$minerServices.uploadFile(this.host),a,n).then((function(e){t.$emit("input",e.data)})).catch((function(e){return console.error(e)}))},update:function(e){this.$emit("input",e)}}},f=h,v=n("2877"),b=Object(v["a"])(f,u,m,!1,null,null,null),g=b.exports,w=n("b5ae"),_=w["helpers"].regex("host",/^((?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9]{0,61}[a-z0-9]|localhost)(:\d{0,5})?$/i),S=w["helpers"].regex("topic",/^([a-z0-9]\/?)*$/i),y={name:"NewStream",props:["streams"],components:{ValidatedInputText:g},validations:{processName:{required:w["required"],minLength:Object(w["minLength"])(2)},brokerHost:{required:w["required"],host:_},topicBase:{required:w["required"],topic:S}},data:function(){return{processName:"",brokerHost:"",topicBase:""}},methods:{validateState:function(e){var t=this.$v[e],n=t.$dirty,a=t.$error;return n?!a:null},handleSubmit:function(){var e=this;this.$v.$touch(),this.$v.$anyError||(this.$emit("add-stream",{processName:this.processName,brokerHost:this.brokerHost,topicBase:this.topicBase}),this.$nextTick((function(){e.$bvModal.hide("new-stream")})))},handleOk:function(e){console.log(1),e.preventDefault(),this.handleSubmit()}}},k=y,$=Object(v["a"])(k,c,l,!1,null,null,null),I=$.exports,x={name:"SidebarStream",props:["streams"],components:{NewStream:I}},C=x,N=Object(v["a"])(C,r,o,!1,null,null,null),T=N.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-sidebar",{attrs:{id:"sidebar-miners",title:"Miners",shadow:"",backdrop:""},scopedSlots:e._u([{key:"footer",fn:function(t){return[n("div",{staticClass:"p-3"},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-miner",modifiers:{"new-miner":!0}}],attrs:{block:""}},[n("font-awesome-icon",{attrs:{icon:"plus"}}),e._v(" New miner host ")],1)],1)]}}])},[n("b-list-group",{staticClass:"py-2",attrs:{flush:""}},e._l(Object.keys(e.miners),(function(t){return n("b-list-group-item",{key:t,staticClass:"bg-light"},[n("table",[e._l(e.miners[t],(function(t){return n("tr",{key:t.id},[n("td",{staticClass:"align-top"},[n("font-awesome-icon",{attrs:{icon:"cogs"}})],1),n("td",[e._v(e._s(t.name))])])})),n("tr",[n("td",[n("small",[n("font-awesome-icon",{class:e.minersStatus[t],attrs:{icon:"circle"}})],1)]),n("td",[n("small",[e._v(e._s(e.getMinerStatus(t)))])])]),n("tr",[n("td",[n("small",[n("font-awesome-icon",{attrs:{icon:"server"}})],1)]),n("td",[n("small",[n("code",[e._v(e._s(t.replace("http://","").replace("https://","")))])])])])],2)])})),1)],1),n("NewMiner",{on:{"add-miner":function(t){return e.$emit("add-miner",t)}}})],1)},P=[],V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"new-miner",title:"New Miner"},on:{ok:e.handleOk}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[n("ValidatedInputText",{attrs:{label:"Miner host:",placeholder:"http://miner.host.net",error:"Enter the host of the miner (examples: <code>http://miner.host.net</code> or <code>https://miner.host.net</code>)",type:"text",state:e.validateState("minerHost")},model:{value:e.minerHost,callback:function(t){e.minerHost=t},expression:"minerHost"}})],1)])},M=[],H=w["helpers"].regex("host",/^https?:\/\/((?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9]{0,61}[a-z0-9]|localhost)(:\d{0,5})?$/i),E={name:"NewMiner",props:["miners"],components:{ValidatedInputText:g},data:function(){return{minerHost:""}},validations:{minerHost:{required:w["required"],host:H}},methods:{validateState:function(e){var t=this.$v[e],n=t.$dirty,a=t.$error;return n?!a:null},handleSubmit:function(){var e=this;this.$v.$touch(),this.$v.$anyError||(this.$emit("add-miner",{host:this.minerHost}),this.$nextTick((function(){e.$bvModal.hide("new-miner")})))},handleOk:function(e){e.preventDefault(),this.handleSubmit()}}},j=E,D=Object(v["a"])(j,V,M,!1,null,null,null),B=D.exports,L={name:"SidebarMiners",props:["miners","minersStatus"],components:{NewMiner:B},methods:{getMinerStatus:function(e){return"online"==this.minersStatus[e]?"System online":"connecting"==this.minersStatus[e]?"Connecting...":"System offline"}}},z=L,q=(n("47de"),Object(v["a"])(z,O,P,!1,null,"cb3a7992",null)),U=q.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-sidebar",{attrs:{id:"sidebar-instances",title:"Instances",shadow:"",backdrop:"",visible:""},scopedSlots:e._u([{key:"footer",fn:function(t){return[n("div",{staticClass:"p-3"},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-instance",modifiers:{"new-instance":!0}}],attrs:{block:""}},[n("font-awesome-icon",{attrs:{icon:"plus"}}),e._v(" New miner instance ")],1)],1)]}}])},[n("b-list-group",{staticClass:"py-2",attrs:{flush:""}},e._l(e.instances,(function(t){return n("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"details-id-"+t.id,expression:"'details-id-' + i.id"}],key:t.id,staticClass:"bg-light"},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.bottom",value:"Open this instance",expression:"'Open this instance'",modifiers:{hover:!0,bottom:!0}}],staticClass:"float-right ml-1",attrs:{size:"sm",variant:"outline-secondary",to:{name:"InstanceViewer",params:{instanceId:t.id,host:e.minerIdToHost(t.miner.id),protocol:e.minerIdToProtocol(t.miner.id)}}},on:{click:function(e){e.stopPropagation()}}},[n("font-awesome-icon",{attrs:{icon:"folder-open"}})],1),n("font-awesome-icon",{attrs:{icon:"sliders-h"}}),e._v(" "+e._s(t.configuration.name)+" "),n("b-collapse",{staticClass:"pt-2",attrs:{id:"details-id-"+t.id}},[n("small",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:t.configuration.stream.processName,expression:"i.configuration.stream.processName",modifiers:{hover:!0}}],staticClass:"mb-1",staticStyle:{"white-space":"nowrap",overflow:"hidden",display:"block"}},[n("font-awesome-icon",{attrs:{icon:"film"}}),e._v(" "+e._s(t.configuration.stream.processName)+" ")],1),n("small",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:t.miner.name,expression:"i.miner.name",modifiers:{hover:!0}}],staticClass:"mb-1",staticStyle:{"white-space":"nowrap",overflow:"hidden",display:"block"}},[n("font-awesome-icon",{attrs:{icon:"cogs"}}),e._v(" "+e._s(t.miner.name)+" ")],1),n("small",{staticClass:"mb-1",staticStyle:{"white-space":"nowrap",overflow:"hidden",display:"block"}},[n("font-awesome-icon",{class:e.instancesStatus[t.id],attrs:{icon:"circle"}}),e._v("  "),"mining"==e.instancesStatus[t.id]?n("span",[e._v("Running")]):e._e(),"not_mining"==e.instancesStatus[t.id]?n("span",[e._v("Not running")]):e._e(),"configuring"==e.instancesStatus[t.id]?n("span",[e._v("Configuring...")]):e._e()],1),n("small",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:e.minerIdToHost(t.miner.id),expression:"minerIdToHost(i.miner.id)",modifiers:{hover:!0}}],staticStyle:{"white-space":"nowrap",overflow:"hidden",display:"block"}},[n("font-awesome-icon",{attrs:{icon:"server"}}),e._v(" "),n("code",[e._v(e._s(e.minerIdToHost(t.miner.id).replace("http://","").replace("https://","")))])],1)])],1)})),1)],1),n("NewInstance",{attrs:{streams:e.streams,miners:e.miners},on:{"new-instance":e.newInstance}}),n("ConfigureInstance",{attrs:{miner:e.miner,host:e.host},on:{"configure-instance":e.configureInstance}})],1)},G=[],A=(n("ac1f"),n("1276"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"new-instance",title:"New Miner Instance"},on:{ok:e.handleOk}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[n("ValidatedInputText",{attrs:{label:"Instance name:",placeholder:"Instance name",error:"Enter the instance name name (at lest 2 character)",type:"text",state:e.validateState("name")},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("b-form-group",{staticClass:"mt-3"},[n("b-dropdown",{attrs:{text:"Select stream - "+e.stream.processName,block:"",variant:"outline-secondary"}},e._l(e.streams,(function(t){return n("b-dropdown-item",{key:t.name,staticClass:"py-2",on:{click:function(n){e.stream=t}}},[n("font-awesome-icon",{attrs:{icon:"film"}}),e._v(" "+e._s(t.processName)),n("br"),n("small",[n("font-awesome-icon",{attrs:{icon:"server"}}),e._v(" "),n("code",[e._v(e._s(t.brokerHost))]),e._v(" / "),n("code",[e._v(e._s(t.topicBase))])],1)],1)})),1),n("b-form-invalid-feedback",{attrs:{state:""!==e.stream.processName}},[e._v(" A stream has to be selected ")])],1),n("b-form-group",[n("b-dropdown",{attrs:{text:"Select Miner - "+e.miner.name,block:"",variant:"outline-secondary"}},e._l(Object.keys(e.miners),(function(t){return n("b-dropdown-group",{key:t},e._l(e.miners[t],(function(a){return n("b-dropdown-item",{key:a.id,staticClass:"py-2",on:{click:function(n){e.miner=a,e.host=t}}},[n("font-awesome-icon",{attrs:{icon:"cogs"}}),e._v(" "+e._s(a.name)),n("br"),n("small",[n("font-awesome-icon",{attrs:{icon:"server"}}),e._v(" "),n("code",[e._v(e._s(t))])],1)],1)})),1)})),1),n("b-form-invalid-feedback",{attrs:{state:""!==e.miner.name}},[e._v(" A miner has to be selected ")])],1)],1)])}),Z=[],R={name:"NewInstance",props:["streams","miners"],components:{ValidatedInputText:g},data:function(){return{name:"",stream:{processName:""},miner:{name:""},host:""}},validations:{name:{required:w["required"],minLength:Object(w["minLength"])(2)}},methods:{validateState:function(e){var t=this.$v[e],n=t.$dirty,a=t.$error;return n?!a:null},handleSubmit:function(){var e=this;this.$v.$touch(),this.$v.$anyError||""!==this.stream.processName&&""!==this.miner.name&&(this.$emit("new-instance",{name:this.name,stream:this.stream,miner:this.miner,host:this.host}),this.$nextTick((function(){e.$bvModal.hide("new-instance")})))},handleOk:function(e){e.preventDefault(),this.handleSubmit()}}},J=R,Q=Object(v["a"])(J,A,Z,!1,null,null,null),W=Q.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"configure-instance",title:"Configure Miner: "+e.miner.name},on:{ok:e.handleOk}},[n("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},e._l(e.miner.configurationParameters,(function(t){return n("ValidatedInputText",{key:t.name,attrs:{label:t.name+":",type:t.type,placeholder:t.defaultValue,host:e.host,error:"A "+t.type.toLowerCase()+" is required",state:e.validateState(t)},model:{value:e.parameters[t.name],callback:function(n){e.$set(e.parameters,t.name,n)},expression:"parameters[p.name]"}})})),1)])},K=[],Y=(n("b64b"),n("2ef0")),ee=n.n(Y),te={name:"ConfigureInstance",props:["host","miner"],components:{ValidatedInputText:g},data:function(){return{parameters:{}}},validations:function(){var e={parameters:{}};return ee.a.each(this.miner.configurationParameters,(function(t){"DOUBLE"==t.type?e.parameters[t.name]={required:w["required"],decimal:w["decimal"]}:e.parameters[t.name]={required:w["required"]}})),e},methods:{validateState:function(e){if(e.name in this.parameters){var t=this.$v.parameters[e.name],n=t.$dirty,a=t.$error;return n?!a:null}},handleSubmit:function(){var e=this;if(this.$v.$touch(),!this.$v.$anyError){for(var t=[],n=Object.keys(this.parameters),a=0;a<n.length;++a){var s=n[a];t.push({name:s,value:this.parameters[s]})}this.$emit("configure-instance",t),this.$nextTick((function(){e.$bvModal.hide("configure-instance")}))}},handleOk:function(e){e.preventDefault(),this.handleSubmit()}}},ne=te,ae=Object(v["a"])(ne,X,K,!1,null,null,null),se=ae.exports,ie={name:"SidebarInstances",props:["streams","miners","instances","instancesStatus"],components:{NewInstance:W,ConfigureInstance:se},data:function(){return{miner:{name:null},stream:{},name:"",host:""}},methods:{minerIdToHost:function(e){for(var t in this.miners)for(var n in this.miners[t])if(this.miners[t][n].id==e)return t.split("://")[1];return"null"},minerIdToProtocol:function(e){for(var t in this.miners)for(var n in this.miners[t])if(this.miners[t][n].id==e)return t.split("://")[0];return"null"},newInstance:function(e){this.miner=e.miner,this.stream=e.stream,this.name=e.name,this.host=e.host,this.miner.configurationParameters.length>0?this.$bvModal.show("configure-instance"):this.configureInstance([])},configureInstance:function(e){this.$emit("create-instance",{miner:this.miner,stream:this.stream,parameterValues:e,name:this.name,host:this.host})}}},re=ie,oe=(n("bdd4"),Object(v["a"])(re,F,G,!1,null,"606acfba",null)),ce=oe.exports,le={name:"App",components:{SidebarStreams:T,SidebarMiners:U,SidebarInstances:ce},data:function(){return{streams:[],miners:{},minersStatus:{},instances:{},instancesStatus:{},polling:null}},methods:{addMiner:function(e){var t=this;this.$set(this.miners,e.host,{}),this.$set(this.minersStatus,e.host,"connecting"),p.a.get(this.$minerServices.getMiners(e.host)).then((function(n){t.$set(t.minersStatus,e.host,"online"),t.$set(t.miners,e.host,ee.a.sortBy(n.data,["name"])),t.refreshData(),t.$toastr.s("New miner added")})).catch((function(n){t.$set(t.minersStatus,e.host,"offline"),t.$toastr.e(n)}))},addStream:function(e){void 0==ee.a.find(this.streams,e)&&(this.streams.push(e),this.$toastr.s("New stream added"))},createInstance:function(e){var t=this;p.a.post(this.$minerServices.createInstance(e.host,e.miner.id),{name:e.name,stream:e.stream,parameterValues:e.parameterValues}).then((function(){t.$toastr.s("New instance created"),t.refreshData()})).catch((function(e){return console.error(e)}))},startInstance:function(e){var t=this;p.a.get(this.$minerServices.startInstance(e.protocol+"://"+e.host,e.instance.id)).then((function(n){1==n.data?(t.$toastr.s("Instance started"),t.$set(t.instancesStatus,e.instance.id,"mining")):t.$toastr.e("Instance not started correctly")})).catch((function(e){return console.error(e)}))},stopInstance:function(e){var t=this;p.a.get(this.$minerServices.stopInstance(e.protocol+"://"+e.host,e.instance.id)).then((function(n){1==n.data?(t.$toastr.s("Instance stopped"),t.$set(t.instancesStatus,e.instance.id,"not_mining")):t.$toastr.e("Instance not stopped correctly")})).catch((function(e){return console.error(e)}))},deleteInstance:function(e){var t=this;p.a.delete(this.$minerServices.deleteInstance(this.minerIdToHost(e.miner.id),e.id)).then((function(){t.refreshData(),t.$delete(t.instances,e.id),t.$toastr.s("Instance deleted"),t.$router.push("/")})).catch((function(e){return console.error(e)}))},refreshData:function(){var e=this,t=function(t){p.a.get(e.$minerServices.getInstances(t)).then((function(n){for(var a in n.data){var s=n.data[a];p.a.get(e.$minerServices.getInstanceStatus(t,s.id),{headers:{instanceId:s.id}}).then((function(t){e.$set(e.instancesStatus,t.config.headers.instanceId,t.data.toLowerCase())})).catch((function(e){return console.error(e)})),s.id in e.instances||(e.$set(e.instances,s.id,s),e.addStream(s.configuration.stream))}})).catch((function(e){return console.error(e)}))};for(var n in this.miners)t(n)},minerIdToHost:function(e){for(var t in this.miners)for(var n in this.miners[t])if(this.miners[t][n].id==e)return t;return"null"},pollData:function(){this.polling=setInterval(this.refreshData,1e4)}},beforeDestroy:function(){clearInterval(this.polling)},mounted:function(){this.addStream({processName:"Hospital log",brokerHost:"broker.hivemq.com",topicBase:"pmcep"}),this.addStream({processName:"BPIC15_3.xes",brokerHost:"broker.hivemq.com",topicBase:"pmcep"}),this.addStream({processName:"Disco Example Log",brokerHost:"broker.hivemq.com",topicBase:"pmcep"}),this.addStream({processName:"BPIC15_1.xes",brokerHost:"broker.hivemq.com",topicBase:"pmcep"}),this.addStream({processName:"test",brokerHost:"broker.hivemq.com",topicBase:"pmcep"}),this.addStream({processName:"test",brokerHost:"localhost",topicBase:"pmcep"}),this.addMiner({host:"https://basic-miners.beamline.cloud"}),this.addMiner({host:"https://declare-miners.beamline.cloud"}),this.addMiner({host:"https://basic-petrinet-conformance.beamline.cloud"})},created:function(){document.title="Beamline Dashboard",this.pollData()}},ue=le,me=(n("034f"),Object(v["a"])(ue,s,i,!1,null,null,null)),de=me.exports,pe=n("8c4f"),he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button-group",{staticClass:"mt-3 float-right"},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.top",value:"Delete this instance",expression:"'Delete this instance'",modifiers:{hover:!0,top:!0}}],attrs:{variant:"outline-secondary"},on:{click:function(t){e.disconnect(),e.$emit("delete-instance",e.instance)}}},[n("font-awesome-icon",{attrs:{icon:"trash"}})],1)],1),n("b-button-group",{staticClass:"float-right mr-3 mt-3"},[n("b-button",{attrs:{variant:"outline-secondary",disabled:"not_mining"!=e.instancesStatus[e.instance.id]},on:{click:function(t){return e.$emit("start-instance",{instance:e.instance,protocol:e.protocol,host:e.host})}}},[n("font-awesome-icon",{attrs:{icon:"play"}}),e._v(" Start ")],1),n("b-button",{attrs:{variant:"outline-secondary",disabled:"mining"!=e.instancesStatus[e.instance.id]},on:{click:function(t){return e.$emit("stop-instance",{instance:e.instance,protocol:e.protocol,host:e.host})}}},[n("font-awesome-icon",{attrs:{icon:"pause"}}),e._v(" Stop ")],1)],1),n("h3",{staticClass:"py-3"},[n("font-awesome-icon",{staticClass:"small",class:e.instancesStatus[e.instance.id],attrs:{icon:"circle"}}),e._v(" "+e._s(e.instance.configuration.name)+" "),n("small",{staticClass:"text-muted"},["mining"==e.instancesStatus[e.instance.id]?n("span",[e._v("(instance running)")]):e._e(),"not_mining"==e.instancesStatus[e.instance.id]?n("span",[e._v("(instance not running)")]):e._e(),"configuring"==e.instancesStatus[e.instance.id]?n("span",[e._v("(instance being prepared)")]):e._e()])],1),"mining"==e.instancesStatus[e.instance.id]?n("b-row",{attrs:{fluid:""}},[n("b-col",{staticClass:"mb-3",staticStyle:{background:"white"},attrs:{md:"3"}},[n("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[n("h6",{staticClass:"mb-0"},[e._v("View configuration")])]},proxy:!0}],null,!1,1711407490)},[n("b-card-text",[e._l(e.instance.miner.viewParameters,(function(t){return n("b-form-group",{key:t.name,attrs:{label:t.name+":"}},["range_0_1"==t.type.toLowerCase()?n("vue-slider",{attrs:{min:0,max:1,interval:.01,default:.5,lazy:!0},on:{change:e.parameterValueUpdated},model:{value:e.viewParameters[t.name],callback:function(n){e.$set(e.viewParameters,t.name,n)},expression:"viewParameters[p.name]"}}):n("b-form-input",{attrs:{required:"",placeholder:t.defaultValue,debounce:"500"},on:{update:e.parameterValueUpdated},model:{value:e.viewParameters[t.name],callback:function(n){e.$set(e.viewParameters,t.name,n)},expression:"viewParameters[p.name]"}})],1)})),e.instance.miner.viewParameters.length>0?n("b-form-checkbox",{staticClass:"mt-3",attrs:{switch:""},model:{value:e.updateOnNewValue,callback:function(t){e.updateOnNewValue=t},expression:"updateOnNewValue"}},[e._v(" Update on new parameter value ")]):e._e(),e.updateOnNewValue?e._e():n("b-button",{staticClass:"mt-2",on:{click:e.updateViews}},[e._v(" Update view ")])],2)],1)],1),n("b-col",{attrs:{md:"9"}},[n("b-tabs",{staticStyle:{background:"white"},attrs:{"content-class":"mt-3"}},e._l(e.views,(function(t){return n("b-tab",{key:t.name,attrs:{lazy:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(t.name)+" "),"raw"==t.type.toLowerCase()?n("font-awesome-icon",{attrs:{icon:"file-alt"}}):e._e(),"graphviz"==t.type.toLowerCase()?n("font-awesome-icon",{attrs:{icon:"image"}}):e._e(),"binary"==t.type.toLowerCase()?n("font-awesome-icon",{attrs:{icon:"download"}}):e._e(),"google"==t.type.toLowerCase()?n("font-awesome-icon",{attrs:{icon:"table"}}):e._e()]},proxy:!0}],null,!0)},["raw"==t.type.toLowerCase()?n("div",{staticClass:"border w-100 p-2 raw-tab"},[n("RawTab",{attrs:{value:t.value}})],1):e._e(),"graphviz"==t.type.toLowerCase()?n("div",[n("SvgTab",{attrs:{value:t.value}})],1):e._e(),"binary"==t.type.toLowerCase()?n("div",[t.value.startsWith("http")?n("BinaryTab",{attrs:{value:t.value}}):e._e(),t.value.startsWith("http")?e._e():n("BinaryTab",{attrs:{value:e.host+t.value}})],1):e._e(),"google"==t.type.toLowerCase()?n("div",{staticClass:"border w-100 gchart"},[n("GoogleChartTab",{attrs:{data:t.value.data,type:t.value.type,options:t.value.options}})],1):e._e()])})),1)],1)],1):e._e()],1)},fe=[],ve=n("4971"),be=n.n(ve),ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("SvgPanZoom",{staticClass:"border w-100 svg-panzoom",class:{loading:!e.svg},attrs:{viewportSelector:".graph",zoomEnabled:!0,controlIconsEnabled:!0,panEnabled:!0,fit:!1,center:!0,minZoom:.1,maxZoom:3},on:{svgpanzoom:e.registerSvgPanZoom}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[n("g",{staticClass:"graph svg-pan-zoom_viewport",domProps:{innerHTML:e._s(e.svg)}})])])},we=[],_e=(n("d81d"),n("2042")),Se=n("1c91"),ye=n.n(Se),ke=n("2c0f"),$e=n.n(ke),Ie={name:"SvgTab",props:["value"],components:{SvgPanZoom:$e.a},data:function(){return{svg:null}},watch:{value:"update"},methods:{registerSvgPanZoom:function(e){this.svgpanzoom=e},update:function(){var e=this,t=new _e["a"]({workerURL:ye.a});this.svg=null,t.renderSVGElement(this.value).then((function(t){e.viewBox=t.getAttribute("viewBox").split(" ").map(Math.ceil);var n=t.getElementsByClassName("graph")[0].innerHTML;e.svg=n})).catch((function(t){e.$toastr.e("Error while rendering the graph"),console.error(t)}))}},mounted:function(){this.update()}},xe=Ie,Ce=(n("28e4"),Object(v["a"])(xe,ge,we,!1,null,"1064796e",null)),Ne=Ce.exports,Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{domProps:{innerHTML:e._s(e.value)}})},Oe=[],Pe={name:"RawTab",props:["value"]},Ve=Pe,Me=Object(v["a"])(Ve,Te,Oe,!1,null,null,null),He=Me.exports,Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("File: "),n("code",{domProps:{innerHTML:e._s(e.value)}})]),n("b-button",{attrs:{href:e.value,target:"_blank"}},[e._v(" Download ")])],1)},je=[],De={name:"BinaryTab",props:["value"]},Be=De,Le=Object(v["a"])(Be,Ee,je,!1,null,null,null),ze=Le.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("GChart",{staticClass:"h-100",attrs:{type:e.type,data:e.data,options:e.options}})},Ue=[],Fe=n("cb43"),Ge={name:"GoogleChartTab",props:["data","type","options"],components:{GChart:Fe["GChart"]}},Ae=Ge,Ze=Object(v["a"])(Ae,qe,Ue,!1,null,null,null),Re=Ze.exports,Je=n("cc7d"),Qe=n.n(Je),We=n("c6e1"),Xe=n.n(We),Ke={name:"InstanceViewer",props:["instances","instancesStatus","protocol","host","instanceId"],components:{SvgTab:Ne,RawTab:He,BinaryTab:ze,GoogleChartTab:Re,VueSlider:be.a},data:function(){return{instance:{id:"",configuration:{name:null},miner:{viewParameters:[]}},connectedInstaces:{},viewParameters:{},views:[],updateOnNewValue:!1,latestViewUpdateFetched:null}},created:function(){this.fetchData()},watch:{$route:"fetchData",instancesStatus:{handler:function(){"mining"==this.instancesStatus[this.instance.id]?this.connect():this.disconnect()},deep:!0}},methods:{fetchData:function(){this.disconnect(),this.viewParameters={},this.views=[],this.dots=[],this.updateOnNewValue=!1,void 0!==this.instances[this.instanceId]?this.instance=this.instances[this.instanceId]:this.$router.push("/"),"mining"==this.instancesStatus[this.instance.id]&&this.connect()},parameterValueUpdated:function(){this.updateOnNewValue&&this.updateViews()},updateViews:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=(new Date).getTime();if(!(n-this.latestViewUpdateFetched<1e3)){this.latestViewUpdateFetched=(new Date).getTime();var a=[];for(var s in this.viewParameters)a.push({name:s,value:this.viewParameters[s]});p.a.post(this.$minerServices.getInstanceView(this.protocol+"://"+this.host,this.instance.id),a).then((function(n){e.views=n.data,e.dots=[],t&&e.$toastr.s("Views updated successfully")})).catch((function(t){console.error(t),e.$toastr.e("Error in updating views")}))}},connect:function(){var e=this;if("mining"==this.instancesStatus[this.instance.id]&&!this.connectedInstaces[this.instance.id]){var t=this;this.socket=new Qe.a(this.protocol+"://"+this.host+"/websockets"),this.stompClient=Xe.a.over(this.socket),this.stompClient.debug=function(){},this.stompClient.connect({},(function(){e.connectedInstaces[e.instance.id]=!0,console.log("connected to: /"+t.instance.id),e.stompClient.subscribe("/"+t.instance.id,(function(e){var n=JSON.parse(e.body);"refresh"==n.type.toLowerCase()?t.updateViews(!1):"toastr"==n.type.toLowerCase()&&t.$toastr.i(ee.a.escape(n.text))}))}),(function(e){console.log(e)}))}},disconnect:function(){this.stompClient&&this.stompClient.connected&&(console.log("disconnected"),this.stompClient.disconnect(),this.connectedInstaces[this.instance.id]=!1)}}},Ye=Ke,et=(n("585c"),Object(v["a"])(Ye,he,fe,!1,null,"44632a88",null)),tt=et.exports;a["default"].use(pe["a"]);var nt=[{path:"/instances/:protocol/:host/:instanceId",name:"InstanceViewer",component:tt,props:!0}],at=new pe["a"]({routes:nt}),st=at,it=(n("f9e3"),n("2dd8"),n("5f5b")),rt=n("ecee"),ot=n("c074"),ct=n("ad3d"),lt=n("025a"),ut=n("1dce"),mt=n.n(ut),dt=(n("24df"),n("d4ec")),pt=n("bee2"),ht=function(){function e(){Object(dt["a"])(this,e)}return Object(pt["a"])(e,[{key:"getMiners",value:function(e){return e+"/api/v1/miners"}},{key:"getInstances",value:function(e){return e+"/api/v1/instances"}},{key:"createInstance",value:function(e,t){return e+"/api/v1/instances/"+t}},{key:"getInstanceStatus",value:function(e,t){return e+"/api/v1/instances/"+t+"/status"}},{key:"getInstanceView",value:function(e,t){return e+"/api/v1/instances/"+t+"/views"}},{key:"startInstance",value:function(e,t){return e+"/api/v1/instances/"+t+"/start"}},{key:"stopInstance",value:function(e,t){return e+"/api/v1/instances/"+t+"/stop"}},{key:"deleteInstance",value:function(e,t){return e+"/api/v1/instances/"+t+"/delete"}},{key:"uploadFile",value:function(e){return e+"/api/v1/upload"}}]),e}();a["default"].use(it["a"]),rt["c"].add(ot["a"]),a["default"].component("font-awesome-icon",ct["a"]),a["default"].use(lt["a"],{defaultPosition:"toast-bottom-right",defaultStyle:{opacity:"1","box-shadow":"none"}}),a["default"].use(mt.a),a["default"].use(Fe["default"]),a["default"].component("VueSlider",be.a),a["default"].prototype.$minerServices=new ht,a["default"].config.productionTip=!1,new a["default"]({router:st,render:function(e){return e(de)}}).$mount("#app")},"585c":function(e,t,n){"use strict";n("2d35")},"6b37":function(e,t,n){},"85ec":function(e,t,n){},bdd4:function(e,t,n){"use strict";n("fdff")},c48e:function(e,t,n){},fdff:function(e,t,n){}});
//# sourceMappingURL=app.f0b22cad.js.map